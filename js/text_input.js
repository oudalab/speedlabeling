/* 
* This script is for importing the raw data/text
* and for formatting and exporting the labeled text.
*/

var input = `{"date": "2011012", "id": "e6874d82b9c4d010348e7713f3214371c0e9c5443e48b7f78f572ea79ea2e0b4487406ca60fda58eaacb8a80310667a63a57ce46e48966c0d2a00752903b45c2fecae81c5993f57f3db1e1d531cd4ef833cad3fd0df4ee7cb7bd0e74a40e22fa3fbb619f2b86c3f613109bd13bdcad8d3c0d932b42dbacccc5af4430eb11da3496d2c334ab5d22dc_3", "source": "Ad Dustour (Arabic)", "text": "واكد الرفاعي \\"حقيقة العلاقات الاخوية التي تربط بين قيادتي البلدين جلالة الملك عبدالله الثاني واخيه صاحب السمو الشيخ حمد بن خليفة آل ثاني أمير دولة قطر الشقيقة\\" ، مبينا ان هذه العلاقات مستمدة من القواسم المشتركة التي تجمعهما على صعيد الدين والقومية والهدف المشترك ، وان الأردن يتطلع إلى تعزيز هذه العلاقات والدفع بها إلى الأمام.", "coders": ["Collin", "Zach", "Youssef"], "active_coder": "Youssef"}
{"date": "2011021", "id": "e6874d82b9c4d010b8b7dac04374ea41ec080da22210428e012fd95878a061fd72b2b161787e3733c57e5cc8084454830034f353d096597170e8820a43d91aa26a4c20c7355a23ac1b2c2d92bbbab55640202f42021c29377f35287be2f83108ef55a4190753589e63f51a3904e42f58bf3169b06b735f4f02c40da2986912f84d6d3da31212678e_6", "source": "Emirates News Agency (Arabic) (WAM)", "text": "مثمنا وقوفها الدائم إلى جانب الشعب   اللبناني في الظروف الصعبة .", "coders": ["Zach", "Rafeef", "Collin"], "active_coder": "Zach"}
{"date": "2011012", "id": "e6874d82b9c4d0106356e6aa282cb0558dc82d2cf5541883b2b4e6de5a13ee1c380689cce4c458d87079cb2e4560976f8a74413d952403b3ac1f1438bd3a2d0b5e5b5181eb2984ee3b6dd5661a032d0b6fa0b841e262d645d78ad4614b4ac10eb75f54eb09403337adc141976973f3a6f0f27e1636b7f2d27e04f0b6853279e73bc29b859125d92c_3", "source": "As-Safir (Arabic)", "text": "نحو عشرين ممثلاً لهذه المنظمات اجتمعت مساء أمس، في مركز التعبئة التربوية، لإعلانهم عن شجبهم للخروقات التي ترتكبها السفيرة الأميركية في لبنان مورا كونيللي، لاتفاقية فيينا التي تنظم العمل الدبلوماسي، وذلك إثر الزيارة التي قامت بها إلى النائب نقولا فتوش في زحلة، ولفتت المنظمات في نهاية اجتماعها إلى أنه «بعد إجهاض مشروع الشرق الأوسط الكبير، ها هو الوحش الأميركي يطل من جديد بمخالبه الحمراء ليقتلع كرامة شعبنا وكبريائه، وليشعل الفتنة في وطن المقاومة والصمود والتحدي، ها هي الأصابع الأميركية تمتد من جديد لتطال كل مفاصل السياسة اللبنانية وتفاصيلها، وما تصريحات واتصالات رموز الإجرام الأميركي من أوباما إلى كلينتون إلى السيئ الذكر فيلتمان وصولاً إلى سفيرته الوقحة مورا كونيللي إلاّ محاولات بائسة لإشعال نار الفتنة بين اللبنانيين عبر القرار الاتهامي المشبوه الذي يهدف إلى استهداف مقاومتنا الشريفة والطاهرة».", "coders": ["Collin", "Dima", "Youssef"], "active_coder": "Youssef"}
{"date": "2011010", "id": "e6874d82b9c4d0106356e6aa282cb0558dc82d2cf5541883b2b4e6de5a13ee1c380689cce4c458d8041a5e95e863b27e1f92783a3081cc3f5bad7c0fead5ac863ff10199d963e5fd4732f20526aa5d3a226dd00b4a0e78d9efa03c9f233be9b6003dd8f8d22e1c700f8af75a4fab882efbf4dc02f4ba9323b3c09d984a08a45ec9dfa032bdfb6000_17", "source": "As-Safir (Arabic)", "text": "÷ استقبل العلامة السيد علي فضل الله، وفدا من الهيئة الإدارية في «تجمع العلماء المسلمين» برئاسة الشيخ حسان عبد الله.", "coders": ["Youssef", "Daniel", "Collin"]}
{"date": "2011010", "id": "e6874d82b9c4d0106b995b9b069ecb6b7a9c0d990eca6e5b960a74992eef530a91b566a9181a0445ba1063f29cbcd67eeb650881843958c2d1731bf0ca3b8b1d7531cb14dc65f2d6c977c695e4a21ff54c9c0898fa3135d10824d0f9328b9cca3e993ed9d15484546a1651b5942ea12feb296876e03c14ad53a32a0b6df79de749e0c9a2553a31b5_43", "source": "AmmanNet (Arabic)", "text": "والقاعدة تصارع أمريكا بالكر والفر، وتتمدد هي الأخرى رغم تراجع شعبيتها في كثير من الدول لدخولها في صدامات محلية وارتكاب أخطاء إستراتيجية, وكوريا الشمالية تتحدى وتستعرض قوتها العسكرية في جنوب القارة الأسيوية، وتصنع توترا مقلقا لجارتها الجنوبية ولليابان أيضا.", "coders": ["Youssef", "Daniel", "Dima"]}
{"date": "2011010", "id": "e6874d82b9c4d0106356e6aa282cb0558dc82d2cf5541883b2b4e6de5a13ee1c380689cce4c458d8041a5e95e863b27e8db7d8e614524bbb2437eee73c83f074178985c1c0ef657bbc1f0b83203e8421c97d793796e32c5797101d6a4839efd8a5e0758f65975ad660a93504df27df321cb7449a36e745bfa1b77595783d84da419f29f48a344e4c_1", "source": "As-Safir (Arabic)", "text": "لقي منتخب قطر خسارة غير متوقعة (صفر  ـ 2)، في المباراة الإفتتاحية لكأس اسيا «الدوحة 2011»، التي خاضها أمام أوزبكستان في حضور أكثر من 37 الف متفرج من جمهوره تجمعوا في استاد خليفة الدولي وكان في مقدمتهم، أمير دولة قطر الشيخ حمد بن خليفة آل ثاني ورئيس الاتحاد الدولي جوزيف بلاتر ورئيس الاتحاد الاسيوي محمد بن همام.", "coders": ["Zach", "Rafeef", "Collin"]}
{"date": "2011021", "id": "e6874d82b9c4d0103fd007efea0e7eca336dea0efc24441a27868905f8f508400568a4339b405423780fc901f4b44ac8b575a34481f44ba2b38ee248563e74ffab3107e032c056a940200dca6d7aa213dd3b005fb7c428c42c472ff4dbed7a52d942c57dc8e77ae3c0820ee3dc1a3d05bbc56631046119bc32c7bc4b5871a52545827a7e4f7ec525_11", "source": "An-Nahar (Arabic)", "text": "فالشؤون اللبنانية هي من اختصاص شعب لبنان، وهو بوعيه قادر على التوصل إلى الحلول التي يريدها.", "coders": ["Collin", "Dima", "Youssef"]}
{"date": "2011012", "id": "e6874d82b9c4d0106356e6aa282cb0558dc82d2cf5541883b2b4e6de5a13ee1c380689cce4c458d87079cb2e4560976f375f778fed0225d88f86b5bf3e0c35de2db6759926668a643e6348e484b9aaa7198cd883edc44c1f02aa96f10b8a64c27085861b1e757952706d9ebddee1f97f961817fc1b7671676239fc43a0e1259c1d27c3b913f8f30d_32", "source": "As-Safir (Arabic)", "text": "في المقابل، وجه الرئيس الايراني محمود احمدي نجاد تحذيرا الى اسرائيل والولايات المت ـ  ـ  ـ  ـ حدة وبعض الدول الاوروبية داعيا اياها الى «وقف التحريض على الفتنة في لبنان اذا كانت لا تريد ان ينقلب الشعب ضدها».", "coders": ["Daniel", "Rafeef", "Collin"]}`;


function exportDocs() {
  exportString = "";
  outputDocs.forEach(function(outputDoc) {
    exportString += JSON.stringify(outputDoc) + '\n';
  });
  return exportString;
}

function updateLabel(docNum, date, label, answer, _input_hash, _task_hash) {
  if(docNum < inputDocs.length) {
    var outDoc = outputDocs[docNum];
    outDoc.date = date;
    outDoc.label = label;
    outDoc._input_hash = _input_hash;
    outDoc._task_hash = _task_hash;
    outDoc.answer = answer;
    outDoc.submit_time = Date.now();
    outDoc.time_taken = outDoc.submit_time - outDoc.load_time;
    console.log(outDoc.time_taken);
    // console.log(outputDocs[docNum]);
  }
}

// Format is JSONL, split on the newline and parse to JSON
var inputDocs = input.split('\n').map(function(text){
  return JSON.parse(text);
});

// construct output documents
var outputDocs = [];
inputDocs.forEach(function(inputDoc){
  outputDoc = {};
  outputDoc.id = inputDoc.id;
  outputDoc.source = inputDoc.source;
  outputDoc.text = inputDoc.text;
  outputDoc.coders = inputDoc.coders;
  outputDoc.active_coder = inputDoc.active_coder;

  outputDocs.push(outputDoc);
});